<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë§‘ì€ì†Œí”„íŠ¸ ALM</title>
    <meta name="description" content="ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ ìƒëª…ì£¼ê¸° í†µí•© ê´€ë¦¬ í”Œë«í¼">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“‹</text></svg>">

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">

    <!-- Noto Sans KR í°íŠ¸ -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/base.css">
</head>
<body>
    <!-- ì•± ì»¨í…Œì´ë„ˆ -->
    <div id="app"></div>

    <!-- Bootstrap 5 JS Bundle (Popper í¬í•¨) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <!-- Chart.js for analytics charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <!-- ViewLogic Router -->
    <script src="https://cdn.jsdelivr.net/npm/viewlogic@latest/dist/viewlogic-router.min.js"></script>

    <script>
        // ViewLogic Router ì´ˆê¸°í™”
        const router = new ViewLogicRouter({
            basePath: '/',
            srcPath: '/src',
            mode: 'hash',
            useAuth: false, // ê°œë°œ ì‹œ falseë¡œ ì„¤ì •, ë°°í¬ ì‹œ trueë¡œ ë³€ê²½
            authCheck: () => {
                const token = localStorage.getItem('auth_token');
                return !!token;
            },
            authRedirect: '/login'
        });

        // ì „ì—­ ì„¤ì •
        window.APP_NAME = 'Malgnsoft ALM';
        window.APP_VERSION = '1.0.0';

        // ì‚¬ìš©ì ì—­í•  ì •ì˜
        window.USER_ROLES = {
            ADMIN: 'ADMIN',           // ì‹œìŠ¤í…œ ê´€ë¦¬ì
            PM: 'PM',                 // í”„ë¡œì íŠ¸ ë§¤ë‹ˆì €
            DEVELOPER: 'DEVELOPER',   // ê°œë°œì
            QA: 'QA',                 // QA ì—”ì§€ë‹ˆì–´
            VIEWER: 'VIEWER'          // ë·°ì–´ (ì½ê¸° ì „ìš©)
        };

        // í˜„ì¬ ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        window.getCurrentUser = () => {
            const userStr = localStorage.getItem('user');
            if (!userStr) {
                // ê°œë°œìš© ê¸°ë³¸ ì‚¬ìš©ì
                return {
                    id: 1,
                    name: 'ê´€ë¦¬ì',
                    email: 'admin@malgnsoft.com',
                    role: window.USER_ROLES.ADMIN,
                    avatar: null
                };
            }
            return JSON.parse(userStr);
        };

        // ì‚¬ìš©ì ì—­í•  í™•ì¸
        window.hasRole = (role) => {
            const user = window.getCurrentUser();
            return user && user.role === role;
        };

        // ê´€ë¦¬ì ê¶Œí•œ í™•ì¸
        window.isAdmin = () => {
            return window.hasRole(window.USER_ROLES.ADMIN);
        };

        // í¸ì§‘ ê¶Œí•œ í™•ì¸ (ê´€ë¦¬ì + PM + ê°œë°œì)
        window.canEdit = () => {
            const user = window.getCurrentUser();
            return user && (user.role === window.USER_ROLES.ADMIN ||
                          user.role === window.USER_ROLES.PM ||
                          user.role === window.USER_ROLES.DEVELOPER);
        };

        // ë¶„ì„ ê¶Œí•œ í™•ì¸ (ëª¨ë“  ì—­í• )
        window.canViewAnalytics = () => {
            return !!window.getCurrentUser();
        };

        // API í—¬í¼ (ì„ íƒì‚¬í•­)
        window.API_BASE_URL = '/api'; // ì‹¤ì œ API ì„œë²„ ì£¼ì†Œë¡œ ë³€ê²½

        // ê°„ë‹¨í•œ ë¡œê·¸ì•„ì›ƒ í•¨ìˆ˜
        window.logout = () => {
            localStorage.removeItem('auth_token');
            localStorage.removeItem('user');
            window.location.hash = '#/login';
        };

        // ê°œë°œ ëª¨ë“œ í”Œë˜ê·¸
        window.DEV_MODE = true;

        console.log('%cğŸ“‹ Malgnsoft ALM', 'font-size: 20px; font-weight: bold; color: #6366f1;');
        console.log('%cALM ì‹œìŠ¤í…œì´ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤.', 'color: #10b981;');
        console.log('Version:', window.APP_VERSION);
        console.log('User:', window.getCurrentUser().name);
    </script>
</body>
</html>
